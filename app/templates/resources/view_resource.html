{% extends "base.html" %}

{% block title %}{{ resource.title }} - {{ app_name }}{% endblock %}

{% block content %}
<div class="view-resource-container">
    <div class="back-link">
        <a href="{{ url_for('main.browse_resources') }}">‚Üê Back to Browse</a>
    </div>

    <div class="resource-main">
        <div class="resource-content">
            <div class="resource-header">
                <div class="file-icon-large">
                    {% if resource.file_type in ['pdf'] %}üìÑ
                    {% elif resource.file_type in ['doc', 'docx'] %}üìù
                    {% elif resource.file_type in ['ppt', 'pptx'] %}üìä
                    {% elif resource.file_type in ['xls', 'xlsx'] %}üìà
                    {% elif resource.file_type in ['jpg', 'jpeg', 'png', 'gif'] %}üñºÔ∏è
                    {% elif resource.file_type in ['zip'] %}üóúÔ∏è
                    {% else %}üìÅ
                    {% endif %}
                </div>
                <div class="header-text">
                    <h1>{{ resource.title }}</h1>
                    <div class="file-meta">
                        <span class="file-type-badge">{{ resource.file_type.upper() }}</span>
                        <span class="file-size">{{ (resource.file_size / 1024 / 1024)|round(2) }} MB</span>
                    </div>
                </div>
            </div>

            {% if resource.description %}
            <div class="description-section">
                <h2>üìù Description</h2>
                <p>{{ resource.description }}</p>
            </div>
            {% endif %}

            <div class="metadata-section">
                <h2>‚ÑπÔ∏è Details</h2>
                <div class="metadata-grid">
                    {% if resource.category %}
                    <div class="meta-item">
                        <div class="meta-label">Category</div>
                        <div class="meta-value">{{ resource.category }}</div>
                    </div>
                    {% endif %}

                    {% if resource.grade_level %}
                    <div class="meta-item">
                        <div class="meta-label">Grade Level</div>
                        <div class="meta-value">{{ resource.grade_level }}</div>
                    </div>
                    {% endif %}

                    {% if resource.difficulty %}
                    <div class="meta-item">
                        <div class="meta-label">Difficulty</div>
                        <div class="meta-value difficulty-{{ resource.difficulty.lower() }}">{{ resource.difficulty }}</div>
                    </div>
                    {% endif %}

                    {% if resource.duration %}
                    <div class="meta-item">
                        <div class="meta-label">Duration</div>
                        <div class="meta-value">{{ resource.duration }}</div>
                    </div>
                    {% endif %}

                    {% if resource.tags %}
                    <div class="meta-item full-width">
                        <div class="meta-label">Tags</div>
                        <div class="meta-value">
                            {% for tag in resource.tags.split(',') %}
                                <span class="tag-badge">{{ tag.strip() }}</span>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    {% if resource.standards %}
                    <div class="meta-item full-width">
                        <div class="meta-label">Standards</div>
                        <div class="meta-value">{{ resource.standards }}</div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="uploader-section">
                <h2>üë§ Uploaded By</h2>
                <div class="uploader-card">
                    <div class="uploader-avatar">{{ uploader.username[0].upper() }}</div>
                    <div class="uploader-info">
                        <a href="{{ url_for('main.profile', username=uploader.username) }}" class="uploader-name">
                            {{ uploader.display_name or uploader.username }}
                        </a>
                        <div class="upload-date">{{ resource.uploaded_at.strftime('%B %d, %Y') }}</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="resource-sidebar">
            <div class="action-card">
                <a href="{{ url_for('main.download_resource', resource_id=resource.id) }}"
                   class="btn-download">
                    ‚¨áÔ∏è Download Resource
                </a>

                {% if current_user.is_authenticated and current_user.id == resource.user_id %}
                <a href="{{ url_for('main.edit_resource', resource_id=resource.id) }}"
                   class="btn-edit">
                    ‚úèÔ∏è Edit Resource
                </a>
                {% endif %}
            </div>

            <div class="stats-card">
                <h3>üìä Statistics</h3>
                <div class="stat-row">
                    <span class="stat-label">Views</span>
                    <span class="stat-value">{{ resource.view_count }}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Downloads</span>
                    <span class="stat-value">{{ resource.download_count }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.view-resource-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.back-link {
    margin-bottom: 20px;
}

.back-link a {
    color: #667eea;
    text-decoration: none;
    font-weight: 600;
}

.back-link a:hover {
    text-decoration: underline;
}

.resource-main {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 30px;
}

.resource-content {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.resource-header {
    padding: 40px;
    background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
    border-radius: 12px 12px 0 0;
    display: flex;
    align-items: center;
    gap: 20px;
}

.file-icon-large {
    font-size: 5em;
}

.header-text h1 {
    margin: 0 0 10px 0;
    color: #1f2937;
    font-size: 2em;
}

.file-meta {
    display: flex;
    gap: 15px;
    align-items: center;
}

.file-type-badge {
    background: #667eea;
    color: white;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.9em;
    font-weight: 600;
}

.file-size {
    color: #6b7280;
    font-size: 0.9em;
}

.description-section, .metadata-section, .uploader-section {
    padding: 30px 40px;
    border-top: 1px solid #e5e7eb;
}

.description-section h2, .metadata-section h2, .uploader-section h2 {
    margin: 0 0 20px 0;
    color: #1f2937;
    font-size: 1.3em;
}

.description-section p {
    color: #4b5563;
    line-height: 1.8;
    font-size: 1.05em;
}

.metadata-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
}

.meta-item {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.meta-item.full-width {
    grid-column: 1 / -1;
}

.meta-label {
    font-weight: 600;
    color: #6b7280;
    font-size: 0.85em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.meta-value {
    color: #1f2937;
    font-size: 1.05em;
}

.difficulty-easy {
    color: #065f46;
    font-weight: 600;
}

.difficulty-medium {
    color: #92400e;
    font-weight: 600;
}

.difficulty-hard {
    color: #991b1b;
    font-weight: 600;
}

.tag-badge {
    display: inline-block;
    padding: 6px 12px;
    background: #f3f4f6;
    color: #4b5563;
    border-radius: 12px;
    font-size: 0.9em;
    font-weight: 600;
    margin-right: 8px;
    margin-bottom: 8px;
}

.uploader-card {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 20px;
    background: #f9fafb;
    border-radius: 12px;
}

.uploader-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2em;
    font-weight: bold;
}

.uploader-name {
    display: block;
    color: #1f2937;
    font-weight: 600;
    font-size: 1.1em;
    text-decoration: none;
    margin-bottom: 5px;
}

.uploader-name:hover {
    color: #667eea;
}

.upload-date {
    color: #6b7280;
    font-size: 0.9em;
}

.resource-sidebar {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.action-card, .stats-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    padding: 25px;
}

.btn-download, .btn-edit {
    display: block;
    padding: 15px 20px;
    border-radius: 8px;
    font-weight: 600;
    text-align: center;
    text-decoration: none;
    transition: all 0.3s ease;
    margin-bottom: 10px;
}

.btn-download {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.btn-download:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-edit {
    background: #f3f4f6;
    color: #4b5563;
}

.btn-edit:hover {
    background: #e5e7eb;
}

.stats-card h3 {
    margin: 0 0 20px 0;
    color: #1f2937;
}

.stat-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #e5e7eb;
}

.stat-row:last-child {
    border-bottom: none;
}

.stat-label {
    color: #6b7280;
    font-weight: 600;
}

.stat-value {
    color: #667eea;
    font-weight: bold;
    font-size: 1.2em;
}

@media (max-width: 968px) {
    .resource-main {
        grid-template-columns: 1fr;
    }

    .metadata-grid {
        grid-template-columns: 1fr;
    }

    .resource-header {
        padding: 30px 20px;
        flex-direction: column;
        text-align: center;
    }

    .description-section, .metadata-section, .uploader-section {
        padding: 20px;
    }
}
</style>
{% endblock %}
